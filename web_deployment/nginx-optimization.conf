# Nginx 性能优化配置文件
# 包含 Brotli 压缩、缓存优化等高级功能

# 启用 Brotli 压缩模块（需要先安装 ngx_brotli 模块）
# 安装命令：sudo apt-get install libbrotli-dev
# 或者从源码编译时添加 --add-module=/path/to/ngx_brotli

# 全局性能优化（这些通常在主配置中已定义，注释掉避免冲突）
# client_max_body_size 10M;
# client_body_buffer_size 128k;
# client_header_buffer_size 1k;
# large_client_header_buffers 4 4k;
# output_buffers 1 32k;
# postpone_output 1460;

# 连接优化（注释掉可能冲突的指令）
# keepalive_timeout 65;
# keepalive_requests 100;
# send_timeout 60;
# client_body_timeout 60;
# client_header_timeout 60;

# 文件缓存优化
open_file_cache max=1000 inactive=20s;
open_file_cache_valid 30s;
open_file_cache_min_uses 2;
open_file_cache_errors on;

# 代理缓存优化
proxy_cache_path /tmp/nginx_cache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;

# 日志优化（注释掉可能冲突的指令）
# access_log /var/log/nginx/access.log combined buffer=512k flush=1m;
# error_log /var/log/nginx/error.log warn;

# 隐藏 Nginx 版本信息（注释掉，在站点配置中已定义）
# server_tokens off;

# 启用 sendfile 优化（这些通常在主配置中已定义）
# sendfile on;
# tcp_nopush on;
# tcp_nodelay on;

# 启用 aio 异步 I/O（如果支持）
# aio on;
# directio 512;

# 启用线程池（如果支持）
# thread_pool default threads=32 max_queue=65536;
